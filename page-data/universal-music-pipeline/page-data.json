{"componentChunkName":"component---src-templates-blog-template-js","path":"/universal-music-pipeline/","result":{"data":{"cur":{"id":"4ca27750-f3c2-54a3-a017-4a56749035f9","html":"<h2 id=\"파이프라인-구성-아키텍처\" style=\"position:relative;\"><a href=\"#%ED%8C%8C%EC%9D%B4%ED%94%84%EB%9D%BC%EC%9D%B8-%EA%B5%AC%EC%84%B1-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98\" aria-label=\"파이프라인 구성 아키텍처 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>파이프라인 구성 아키텍처</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 629px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 128.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsTAAALEwEAmpwYAAADTklEQVRIx5VVy27TQBT1F/E3fAFbFiwQAiRW7NmwYoPYILHhISoQokCLoJQFLYQkJc2jiZ34Eb9jJ37bB92b2MRtCnSk8djjmXPPPXPvHQEAiqJA2UzTxNbWFgaDQTW3/v9fTSgX53kO13Wg6zqGwyEkSYLrukiS5EKgQrFcDRozAgbgeR7SNGMj1C8GuAKjnnx8gEw8gGY6CIMFg/H/Fdj/gArri5KjbZi9Q6i6CdMwEATBhXUUUCzdIjd1x2Mw0lE3DR4ty6rpmOVnGa8bE+hBi6aaBnky4VESJYzax1BlBYqiYLFYnGFyWoryXcjVDookqC22dAPG1yMgymrzWZ7jW1eDH6bnSiEsnt5CoHQRJBnmvsehQqwsx4bv+6wjMYyjCEEY4fLd53i914QsDWE7To0hdWHhmsjzJRPSSpZl1o7cJ13LVh6QqlsYjkY4OTnhJDijYRgl1USapsyGFs5mM8RxXP2Logi2baPXPWYwURR5dBynzjAMAmRZVm0koPl8ziMZKBuxpc3UNU2Dqir8TuvW3RbCMGRWZL3f77O79G0YBn+PRqOlppZVGc3SBIN+D61WC81mk/eWoAJpQ51cGo/HHJPEkAAmkwkXCZonViXjeZxDNR02TMxpbwVI7tLmXq/HmhAAjeV7yZCMFKvDm7d3MGu85XRNk4S1LmVbBnaWsbVNnYBKBlU8Nl9De/8QkjKFpqmYTqdVFAj/m6MkheO6sC0L+izAYKxxvhumyYAkCXkqnA7Mv3XT0KHbM3TfPMLx9mPo1vLESRJVXTIVzmO0nqeUcvmaJ357B+PDD/CDCI5j1wqxcF6Sb8rTstgS0K9uH4oscyRQdacw40PZVIKKVWGlFmcptsUOBq7x594xDLSaP9FuH6Hb7XI8UuaQQWEdLAkCFHH9RO1gjkv3buP+57fV3CKOYa0yhFyl+Cyr+xpDoHXjKnauXoHnzbiSNBoN/Gg08PLDO+zuf8H3g0OIiorJ/idMdt8tr46VDLUrgOIwShK07lzH3s1r8Hyf44/SkjryHFmS8j1D0ouvXkB89gReGCFcxV+Vy0SVhB2JIvqrzBAlicOh0nRDFAwkifU7fSv+NbA3xSJXdNPEUbuNTqeDQb9fq4u/ARJyzz8A5nRwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"architecture\"\n        title=\"architecture\"\n        src=\"/static/c4305c6f5081fff829c59e18aca24c1e/63a68/1-universal_final_pipeline.png\"\n        srcset=\"/static/c4305c6f5081fff829c59e18aca24c1e/e9ff0/1-universal_final_pipeline.png 180w,\n/static/c4305c6f5081fff829c59e18aca24c1e/f21e7/1-universal_final_pipeline.png 360w,\n/static/c4305c6f5081fff829c59e18aca24c1e/63a68/1-universal_final_pipeline.png 629w\"\n        sizes=\"(max-width: 629px) 100vw, 629px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"아키텍처-설명\" style=\"position:relative;\"><a href=\"#%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%EC%84%A4%EB%AA%85\" aria-label=\"아키텍처 설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>아키텍처 설명</h2>\n<ol>\n<li><code class=\"language-text\">GET Order IDs</code> :: Lambda\n<ol>\n<li>UCS 에 공개된 데이터를 받아온다.</li>\n<li>받아온 데이터는 Log에 저장 되며 이는 CloudWatch Logs Subscribe Filter를 거쳐 Order ID가 있을 경우 CHECK Order ID를 트리거 한다.</li>\n</ol>\n</li>\n<li><code class=\"language-text\">CHECK Order ID</code> :: Lambda\n<ol>\n<li>Order ID를 기처리 여부를 판단한다.</li>\n<li>처리 할 데이터는 DynamoDB Table에 기록되며(최대 1일간 보관됨), 기 처리된 데이터는 이미 기록되어있으므로 파이프라인이 이대로 종료된다.\n<ol>\n<li>DynamoDB에 기록되는 데이터는 DynamoDB Stream에 의해 상태(Insert, Modify, Delete)가 감지된다.</li>\n</ol>\n</li>\n<li>Insert 상태가 감지되면 ECS Task를 트리거 한다.</li>\n</ol>\n</li>\n<li><code class=\"language-text\">TRIGGER ECS Task</code> :: Lambda\n<ol>\n<li>2에서 트리거 된 정보가 그대로 넘어와 ECS Task를 활성화 시킨다.</li>\n</ol>\n</li>\n<li><code class=\"language-text\">GET Universal Music</code> :: ECS Task\n<ol>\n<li>ECS Task는 Order ID에 따른 파일들을 받아와 EFS에 저장하는 작업을 수행한다.</li>\n</ol>\n</li>\n<li>DataSync\n<ol>\n<li>DataSync는 주기적으로 EFS의 데이터를 S3에 옮기는 작업을 수행한다.</li>\n</ol>\n</li>\n</ol>","excerpt":"파이프라인 구성 아키텍처  아키텍처 설명  :: Lambda UCS 에 공개된 데이터를 받아온다. 받아온 데이터는 Log에 저장 되며 이는 CloudWatch Logs Subscribe Filter를 거쳐 Order ID가 있을 경우 CHECK Order ID를 트리거 한다.  :: Lambda Order ID를 기처리 여부를 판단한다. 처리 할 데이터는 DynamoDB Table에 기록되며(최대 1일간 보관됨), 기 처리된 데이터는 이미 기록되어있으므로 파이프라인이 이대로 종료된다. DynamoDB에 기록되는 데이터는 DynamoDB Stream에 의해 상태(Insert, Modify, Delete)가 감지된다. Insert 상태가 감지되면 ECS Task를 트리거 한다.  :: Lambda 2에서 트리거 된 정보가 그대로 넘어와 ECS Task를 활성화 시킨다.  :: ECS Task ECS Task는 Order ID에 따른 파일들을 받아와 EFS에 저장하는 작업을 수행한다. …","frontmatter":{"date":"January 01, 2022","title":"협력 업체 음원 수급 자동화를 위한 파이프라인 만들기 B (구성하기)","categories":"craft","author":"신나라","emoji":"🔨"},"fields":{"slug":"/universal-music-pipeline/"}},"next":{"id":"3f04f744-98a7-5238-977e-0def1fea31f5","html":"<h2 id=\"a-cloudflare-의-advanced-ddos-를-이용한-방어-전략\" style=\"position:relative;\"><a href=\"#a-cloudflare-%EC%9D%98-advanced-ddos-%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%B0%A9%EC%96%B4-%EC%A0%84%EB%9E%B5\" aria-label=\"a cloudflare 의 advanced ddos 를 이용한 방어 전략 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>A. Cloudflare 의 Advanced DDoS 를 이용한 방어 전략</h2>\n<ol>\n<li>봇넷을 통해 공격이 들어오면 데이터베이스에 부하가 발생하고, 서비스 요청이 정상적으로 처리되지 않는다</li>\n<li>서비스 운영자는 이를 확인하고 Cloudflare 에서 <strong>I’m Under Attack</strong> 모드를 활성화한다</li>\n<li>하지만 언젠가부터 <strong>I’m Under Attack</strong> 을 통과하는 방식의 공격이 발생하였다</li>\n<li>이를 방어하기 위해서 <strong>Rate Limiting</strong> 을 사용하여 방어하려고 하였으나, <strong>Rate Limit</strong> 집계 시점 이전에 이미 방대한 요청이 들어오기 때문에, <strong>능동 방어에는 시간이 걸린다(1분 이상)</strong></li>\n</ol>\n<h2 id=\"b-aws-waf-security-automations-template을-이용한-방어-전략\" style=\"position:relative;\"><a href=\"#b-aws-waf-security-automations-template%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%B0%A9%EC%96%B4-%EC%A0%84%EB%9E%B5\" aria-label=\"b aws waf security automations template을 이용한 방어 전략 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>B. AWS WAF Security Automations Template을 이용한 방어 전략</h2>\n<p><img src=\"~@img/shieldee/waf-securityAutomationtemplate.png\" alt=\"\"></p>\n<ol>\n<li>봇넷을 통해 공격이 들어오면 데이터베이스에 부하가 발생하고, 서비스 요청이 정상적으로 처리되지 않는다</li>\n<li>CloudFront 또는 Application Load Balancer 에서 Access Logs 를 활성화하고, S3에 저장하도록 한다</li>\n<li>S3에 Access Log가 적재된 이후에, Amazon Athena 가 해당 로그를 <strong>5분 단위로 집계</strong>하여, 지정한 요청 임계치를 초과한 IP들을 AWS WAF IP Set에 추가한다</li>\n</ol>\n<ul>\n<li>마찬가지로 집계 시점 이전에 이미 방대한 요청이 들어오므로, <strong>대응이 느리다(5분 이상)</strong></li>\n</ul>\n<h2 id=\"c-shieldee-의-대응-시나리오\" style=\"position:relative;\"><a href=\"#c-shieldee-%EC%9D%98-%EB%8C%80%EC%9D%91-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\" aria-label=\"c shieldee 의 대응 시나리오 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>C. Shieldee 의 대응 시나리오</h2>\n<p><img src=\"~@img/shieldee/shieldee.png\" alt=\"\"></p>\n<ol>\n<li>봇넷을 통해 공격이 들어오면 앞단 NGINX 에서 지정된 Rate Limiting 정책에 해당하는 개별 IP들을 에러 로그로 떨어뜨린다.</li>\n<li>해당 에러 로그를 탐지하자마자 곧바로 엣지 WAF 에 룰셋으로 해당 IP를 블락한다.\n<ul>\n<li>엣지 영역에서 블락하지 못한 트래픽들을 위한 최후방어선으로 동작하며,</li>\n<li><strong>Rate Limiting 탐지 이후 3초 안에 블락한다.</strong></li>\n</ul>\n</li>\n<li>일시적인 오탐 등을 고려하여 1시간 뒤에 해당 IP들을 해제한다.</li>\n</ol>\n<h2 id=\"2-동작-방식\" style=\"position:relative;\"><a href=\"#2-%EB%8F%99%EC%9E%91-%EB%B0%A9%EC%8B%9D\" aria-label=\"2 동작 방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 동작 방식</h2>\n<ol>\n<li>봇넷을 통해 공격이 들어오면, NGINX 의 <strong>Rate Limiting</strong> 기능으로 개별 IP들의 초당 요청 수를 제한하도록 한다\n<ol>\n<li>이 때의 <strong>Rate Limiting</strong> 대상은 동적 컨텐츠 요청 영역으로만 한정한다</li>\n</ol>\n</li>\n<li><strong>Rate Limiting</strong> 에 적용된 IP 들은 NGINX 에러 로그 파일로 기록이 된다.</li>\n<li><strong>fluentd</strong> 로 에러 로그를 테일링(Tailing) 하여, <strong>Rate Limiting</strong> 로그 형식에 맞춰서 정규표현식으로 캡처를 한다</li>\n<li>캡처된 내용을 <strong>Amazon Kinesis Data Streams</strong> 로 전달하고,</li>\n<li><strong>Kinesis Data Streams</strong> 에서 트리거링된 <strong>AWS Lambda</strong> 가 동작하여, 전달된 IP를 <strong>DynamoDB</strong>에 기록한다.</li>\n<li>기록된 정보는 <strong>DynamoDB Streams</strong> 로 <strong>AWS Lambda</strong> 에 전달되는데, 이 때 해당 IP를 Cloudflare Access Rule 에 Block 모드로 추가한다\n<ol>\n<li>Access Rule 에 추가하고 반환받은 Access Rule Id를 <strong>DynamoDB</strong> 에 기록한다</li>\n<li>이 때, <code class=\"language-text\">expirationTime</code> 속성을 TTL 로 추가하고, 기본 TTL을 3600(1시간)으로 지정한다.</li>\n</ol>\n</li>\n<li><strong>DynamoDB</strong> 에서 TTL 이 경과된 항목이 삭제되면서, 해당 내용이 <strong>DynamoDB Streams</strong> 을 통해서 <strong>AWS Lambda</strong> 로 트리거링된다.\n<ol>\n<li><strong>DynamoDB</strong> 에 기록된 Access Rule Id 으로 Cloudflare Access Rule 에 등록된 IP를 해제한다</li>\n</ol>\n</li>\n</ol>","frontmatter":{"date":"January 01, 2022","title":"Shieldee","categories":"craft","author":"신나라","emoji":"🔨"},"fields":{"slug":"/shieldee/"}},"prev":{"id":"9d1d3aba-dc56-5eda-96d7-e10f8da76bcc","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABKklEQVQoz1VQ2W6EMAzc//+yqi+00EKLlsK24QohJFmVc2EqWwLRh5Fjxx7P+JKlH7BJBJN9odEaVVUhjmNkWYbb7cZ5WZbIhYBUGtL2qLSDMncMw4BxHI9IuCzLiC7/QfziQeQ5DzdNw3GHEDnyXOBbFHj9TJGVCrK7o+8HJjvjMs8LiqrGWxhBKYW2bZnEWovH44FlWRjbtkHrFu+BD2c7YFu5Ps/zf4VUKIsCvu+jrms466C1hnPu2Nr3PaZp4mW+H+B6TXjhuq5MeLbNhFVZIQgCbo6iiD+J4GyFclrkeR7SND2U7wpPlmdI1eCaJGxZSnkQnEHDxhiEYcg9pI5AZ9l7WOGEFfopgnwOYYdfWGPRdR0PUyRVpjOc05ts05ss01ko7n10mj9poRL7hLuHlAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./ssm-watcher_4.21.16.png\"\n        title=\"./ssm-watcher_4.21.16.png\"\n        src=\"/static/3e0ca133b4f8d31772ce269e5b5c22da/37523/ssm-watcher_4.21.16.png\"\n        srcset=\"/static/3e0ca133b4f8d31772ce269e5b5c22da/e9ff0/ssm-watcher_4.21.16.png 180w,\n/static/3e0ca133b4f8d31772ce269e5b5c22da/f21e7/ssm-watcher_4.21.16.png 360w,\n/static/3e0ca133b4f8d31772ce269e5b5c22da/37523/ssm-watcher_4.21.16.png 720w,\n/static/3e0ca133b4f8d31772ce269e5b5c22da/302a4/ssm-watcher_4.21.16.png 1080w,\n/static/3e0ca133b4f8d31772ce269e5b5c22da/393aa/ssm-watcher_4.21.16.png 1190w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h1 id=\"0-목적\" style=\"position:relative;\"><a href=\"#0-%EB%AA%A9%EC%A0%81\" aria-label=\"0 목적 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>0. 목적</h1>\n<p>AWS Session Manager를 통해 접근하는 인스턴스(접근 대상)와 접근 주체, 접근 시간, 접근 장소(Source IP)를 알려준다.</p>\n<h1 id=\"1-code-classlanguage-textsettingymlcode\" style=\"position:relative;\"><a href=\"#1-code-classlanguage-textsettingymlcode\" aria-label=\"1 code classlanguage textsettingymlcode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. <code class=\"language-text\">setting.yml</code></h1>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">SLACK_WEBHOOK_URL<span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span> #SLACK WEBHOOK URL\nREGION<span class=\"token operator\">:</span> ap-northeast<span class=\"token number\">-2</span> #Target Region</code></pre></div>\n<h1 id=\"2-그외\" style=\"position:relative;\"><a href=\"#2-%EA%B7%B8%EC%99%B8\" aria-label=\"2 그외 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 그외</h1>\n<p>SSM Watcher는 Serverless Framework를 이용하여 만들어졌으며 기본적으로 Serverless Framework가 설치되어 있는 환경에서 deploy 가능합니다.</p>\n<blockquote>\n<p><a href=\"https://www.serverless.com/\">https://www.serverless.com/</a></p>\n</blockquote>\n<hr>\n<p>:::tip\n설치를 하고 싶다면\n:::</p>\n<h1 id=\"ssm-watcher-사용방법\" style=\"position:relative;\"><a href=\"#ssm-watcher-%EC%82%AC%EC%9A%A9%EB%B0%A9%EB%B2%95\" aria-label=\"ssm watcher 사용방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSM-Watcher 사용방법</h1>\n<ol>\n<li>serverless framework 설치</li>\n</ol>\n<p><a href=\"https://www.serverless.com/framework/docs/getting-started/\">Serverless Getting Started Guide</a></p>\n<ol start=\"2\">\n<li>본 프로그램을 돌릴 로컬환경에서 AWS Config/Credential 설정(세션</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ ~/.aws/credential</code></pre></div>\n<ul>\n<li><code class=\"language-text\">credentials</code> 에서 Access key와 Secret Access key 설정</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ ~/.aws/config</code></pre></div>\n<ul>\n<li><code class=\"language-text\">config</code> 에서 region, profile 설정</li>\n</ul>\n<ol start=\"3\">\n<li><code class=\"language-text\">git clone</code></li>\n</ol>\n<p><a href=\"https://github.com/narashin/ssm-watcher\">GitHub - narashin/ssm-watcher: Tool to detect when your session is activated.</a></p>\n<ol start=\"4\">\n<li>clone한 폴더 내에서 <code class=\"language-text\">npm i</code> 로 패키지 설치</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">npm</span> i</code></pre></div>\n<ol start=\"5\">\n<li><code class=\"language-text\">setting.yml</code> 수정</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">SLACK_WEBHOOK_URL</span><span class=\"token punctuation\">:</span> <span class=\"token string\">''</span> <span class=\"token comment\">#SLACK WEBHOOK URL</span>\n<span class=\"token key atrule\">REGION</span><span class=\"token punctuation\">:</span> ap<span class=\"token punctuation\">-</span>northeast<span class=\"token punctuation\">-</span><span class=\"token number\">2</span> <span class=\"token comment\"># Target Region</span>\n<span class=\"token key atrule\">PROFILE</span><span class=\"token punctuation\">:</span> default <span class=\"token comment\"># 사용할 AWS Profile (2에서 설정)</span></code></pre></div>\n<ul>\n<li>SLACK_WEBHOOK_URL : 알림을 받을 Slack Webhook URL 설정</li>\n<li>REGION : 사용할 Region 설정</li>\n<li>PROFILE : 사용할 AWS Profile 설정</li>\n</ul>\n<ol start=\"6\">\n<li><code class=\"language-text\">sls deploy</code> 로 배포</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ sls deploy</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA/0lEQVQoz42Q226DMBAFDyQkQIBwCbZrY3r7/2+cyriV+tKoD0drWas5o1VXjVg3EEKLNRdO1zO6DajrUduhPr0H1FRoEHVbUhZC+iOrNcQt4sOOtTXWiHUR0yjmUVwrHYDqLM7lE9BPrLU4ZxnHiWURexQxCmvF6y5CEOsqgs9/8yzKZ+AQAvseMcbifcHnh9h3YYyIm3BO3G45TSPaVlwvGZqsTydxueR5AI0xOOeYppnHIxu9uAw0q5gmMfSi7zMw5QfefRelnVR0AL33bNt2GIaQDZPV+5t4LHkx2SSDovjHDbfNE2Okrhv6rjjaks39LoZBjGOey/LL4km+AHJJmtBwYXq9AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./ssm-watcher_1.15.08.png\"\n        title=\"./ssm-watcher_1.15.08.png\"\n        src=\"/static/44011bf9b9123ae4b319fba8cc3df46e/37523/ssm-watcher_1.15.08.png\"\n        srcset=\"/static/44011bf9b9123ae4b319fba8cc3df46e/e9ff0/ssm-watcher_1.15.08.png 180w,\n/static/44011bf9b9123ae4b319fba8cc3df46e/f21e7/ssm-watcher_1.15.08.png 360w,\n/static/44011bf9b9123ae4b319fba8cc3df46e/37523/ssm-watcher_1.15.08.png 720w,\n/static/44011bf9b9123ae4b319fba8cc3df46e/3dde1/ssm-watcher_1.15.08.png 1018w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ol start=\"7\">\n<li>세션 매니저를 통해 세션이 시작되면,</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABKklEQVQoz1VQ2W6EMAzc//+yqi+00EKLlsK24QohJFmVc2EqWwLRh5Fjxx7P+JKlH7BJBJN9odEaVVUhjmNkWYbb7cZ5WZbIhYBUGtL2qLSDMncMw4BxHI9IuCzLiC7/QfziQeQ5DzdNw3GHEDnyXOBbFHj9TJGVCrK7o+8HJjvjMs8LiqrGWxhBKYW2bZnEWovH44FlWRjbtkHrFu+BD2c7YFu5Ps/zf4VUKIsCvu+jrms466C1hnPu2Nr3PaZp4mW+H+B6TXjhuq5MeLbNhFVZIQgCbo6iiD+J4GyFclrkeR7SND2U7wpPlmdI1eCaJGxZSnkQnEHDxhiEYcg9pI5AZ9l7WOGEFfopgnwOYYdfWGPRdR0PUyRVpjOc05ts05ss01ko7n10mj9poRL7hLuHlAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./screenshot.png\"\n        title=\"./screenshot.png\"\n        src=\"/static/3e0ca133b4f8d31772ce269e5b5c22da/37523/screenshot.png\"\n        srcset=\"/static/3e0ca133b4f8d31772ce269e5b5c22da/e9ff0/screenshot.png 180w,\n/static/3e0ca133b4f8d31772ce269e5b5c22da/f21e7/screenshot.png 360w,\n/static/3e0ca133b4f8d31772ce269e5b5c22da/37523/screenshot.png 720w,\n/static/3e0ca133b4f8d31772ce269e5b5c22da/302a4/screenshot.png 1080w,\n/static/3e0ca133b4f8d31772ce269e5b5c22da/393aa/screenshot.png 1190w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>위와 같은 알림 발송</p>","frontmatter":{"date":"January 01, 2022","title":"SSM Watcher","categories":"craft","author":"신나라","emoji":"🔨"},"fields":{"slug":"/ssm-watcher/"}},"site":{"siteMetadata":{"siteUrl":"https://nara.dev","comments":{"utterances":{"repo":"narashin/narashin.github.io"}}}}},"pageContext":{"slug":"/universal-music-pipeline/","nextSlug":"/shieldee/","prevSlug":"/ssm-watcher/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}